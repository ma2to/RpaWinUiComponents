<?xml version="1.0" encoding="utf-8"?>
<!-- Views/AdvancedDataGridControl.xaml - OPRAVA: ZjednoduÅ¡enÃ¡ verzia bez XLS0501 chÃ½b -->
<UserControl
    x:Class="RpaWinUiComponents.AdvancedWinUiDataGrid.Views.AdvancedDataGridControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="using:RpaWinUiComponents.AdvancedWinUiDataGrid.Models"
    xmlns:controls="using:RpaWinUiComponents.AdvancedWinUiDataGrid.Controls"
    xmlns:converters="using:RpaWinUiComponents.AdvancedWinUiDataGrid.Converters"
    xmlns:viewmodels="using:RpaWinUiComponents.AdvancedWinUiDataGrid.ViewModels"
    mc:Ignorable="d"
    d:DataContext="{d:DesignInstance Type=viewmodels:AdvancedDataGridViewModel}">

    <UserControl.Resources>
        <!-- Converters -->
        <converters:ValidationErrorToBrushConverter x:Key="ValidationErrorToBrushConverter"/>
        <converters:ValidationErrorToBorderBrushConverter x:Key="ValidationErrorToBorderBrushConverter"/>
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
        <converters:ObjectToStringConverter x:Key="ObjectToStringConverter"/>
        <converters:ProgressToPercentageConverter x:Key="ProgressToPercentageConverter"/>
        <converters:AlternatingRowBackgroundConverter x:Key="AlternatingRowBackgroundConverter"/>
        <converters:ColumnTypeConverter x:Key="ColumnTypeConverter"/>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <!-- Validation Progress -->
            <RowDefinition Height="Auto"/>
            <!-- Main Content -->
            <RowDefinition Height="*"/>
            <!-- Toggle Button Panel -->
            <RowDefinition Height="Auto"/>
            <!-- Keyboard Shortcuts Helper -->
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Validation Progress Panel -->
        <Border Grid.Row="0" 
                x:Name="ValidationProgressPanel"
                Background="#F8F9FA" 
                Padding="12,8"
                BorderBrush="#DEE2E6"
                BorderThickness="0,0,0,1"
                Visibility="{x:Bind ViewModel.IsValidating, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}">

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Row="0" Grid.Column="0"
                           Text="{x:Bind ViewModel.ValidationStatus, Mode=OneWay}"
                           FontSize="12"
                           Foreground="#6C757D"
                           VerticalAlignment="Center"/>

                <TextBlock Grid.Row="0" Grid.Column="1"
                           Text="{x:Bind ViewModel.ValidationProgress, Mode=OneWay, Converter={StaticResource ProgressToPercentageConverter}}"
                           FontSize="12"
                           FontWeight="Bold"
                           Foreground="#007BFF"
                           Margin="8,0,0,0"
                           VerticalAlignment="Center"/>

                <ProgressBar Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                             Value="{x:Bind ViewModel.ValidationProgress, Mode=OneWay}"
                             Maximum="100"
                             Height="4"
                             Background="#E9ECEF"
                             Foreground="#007BFF"
                             Margin="0,6,0,0"/>
            </Grid>
        </Border>

        <!-- Main Content ScrollViewer -->
        <ScrollViewer Grid.Row="1" 
                      x:Name="MainScrollViewer"
                      ZoomMode="Disabled"
                      HorizontalScrollMode="Auto"
                      VerticalScrollMode="Auto"
                      HorizontalScrollBarVisibility="Auto"
                      VerticalScrollBarVisibility="Auto"
                      Background="#FFFFFF">

            <!-- OPRAVA: ZjednoduÅ¡enÃ¡ Å¡truktÃºra bez Border konfliktov -->
            <StackPanel x:Name="DataGridContainer" MinWidth="800">

                <!-- Headers Row -->
                <Grid x:Name="HeadersGrid" 
                      Background="#F8F9FA" 
                      BorderBrush="#DEE2E6" 
                      BorderThickness="1,1,1,0"
                      Height="40">

                    <!-- Headers budÃº vygenerovanÃ© dynamicky v code-behind -->

                </Grid>

                <!-- Data Rows Container -->
                <StackPanel x:Name="DataRowsContainer">

                    <!-- Rows budÃº vygenerovanÃ© dynamicky v code-behind -->

                </StackPanel>
            </StackPanel>
        </ScrollViewer>

        <!-- Toggle Button Panel -->
        <Border Grid.Row="2" 
                Background="#F8F9FA" 
                Padding="6"
                BorderBrush="#DEE2E6"
                BorderThickness="0,1,0,0">

            <Button x:Name="ToggleKeyboardShortcutsButton"
                    Click="OnToggleKeyboardShortcuts_Click"
                    Background="#F8F9FA"
                    Foreground="Black"
                    BorderBrush="#DEE2E6"
                    BorderThickness="1"
                    HorizontalAlignment="Center"
                    ToolTipService.ToolTip="ZobraziÅ¥/skryÅ¥ klÃ¡vesovÃ© skratky">

                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="ToggleIcon"
                               Text="â–¼"
                               FontSize="12" 
                               Margin="0,0,4,0"
                               VerticalAlignment="Center"/>
                    <TextBlock Text="KlÃ¡vesovÃ© skratky" 
                               FontSize="11" 
                               FontWeight="SemiBold"
                               VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
        </Border>

        <!-- Keyboard Shortcuts Helper -->
        <Border x:Name="KeyboardShortcutsPanel"
                Grid.Row="3" 
                Background="#F8F9FA" 
                Padding="8,6"
                BorderBrush="#DEE2E6"
                BorderThickness="0,1,0,0"
                Visibility="Collapsed">

            <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                <TextBlock FontSize="10" 
                           Foreground="#495057"
                           FontWeight="SemiBold"
                           HorizontalAlignment="Center"
                           Text="âŒ¨ï¸ KLÃVESOVÃ‰ SKRATKY"
                           Margin="0,0,0,2"/>
                <TextBlock FontSize="9" 
                           Foreground="#6C757D"
                           HorizontalAlignment="Center"
                           TextWrapping="Wrap">
                    <Run Text="ðŸ“‹ NavigÃ¡cia:" FontWeight="SemiBold"/>
                    <Run Text="Tab/Shift+Tab = ÄalÅ¡ia/predchÃ¡dzajÃºca bunka â€¢ Enter = ÄalÅ¡Ã­ riadok â€¢ F2 = zaÄaÅ¥ editÃ¡ciu"/>
                    <LineBreak/>
                    <Run Text="âœï¸ EditÃ¡cia:" FontWeight="SemiBold"/>
                    <Run Text="ESC = zruÅ¡iÅ¥ zmeny â€¢ Delete = vymazaÅ¥ obsah â€¢ Shift+Enter = novÃ½ riadok v bunke"/>
                    <LineBreak/>
                    <Run Text="ðŸ“‹ Clipboard:" FontWeight="SemiBold"/>
                    <Run Text="Ctrl+C = kopÃ­rovaÅ¥ â€¢ Ctrl+V = vloÅ¾iÅ¥"/>
                </TextBlock>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>